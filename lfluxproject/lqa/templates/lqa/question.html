{% extends 'base.html' %}
{% load i18n %}
{% load markup %}
{% block content %}
<div id="nav">
    <a href="/">{{site.name}}</a> /
    <a href="{{story.get_absolute_url}}">{{story.name}}<a> /
    {{question.title}}
</div>
<div id="header">
    {% include 'lstory/header.html' with current=story %}

</div>
<div id="summary">
    <h2>{% trans "Question:" %} {{question.title}}</h2>

</div>
<div id="react">
    <div class="inner">
        
        {{question.comment|markdown}}

        <hr />
        {% load threadedcomments_tags %}

        {% get_comment_list for question as comment_list %}
        {% for comment in comment_list|fill_tree|annotate_tree %}
            {% ifchanged comment.parent_id %}{% else %}
                </li>
            {% endifchanged %}

            {% if not comment.open and not comment.close %}
                </li>
            {% endif %}
                
            {% if comment.open %}
                <ul>
            {% endif %}

            <li{% if comment.last %} class="last"{% endif %}>

            {{ comment.comment|markdown }}
            â€” {% if comment.url %}<a href="{{comment.url}}" rel="nofollow">{% endif %}{{comment.user}}{% if comment.url%}</a>{% endif %} <a href="#" onclick="$('#comment_form_for_{{comment.pk}}').toggle(); return false;">(reply)</a>

            <div id="comment_form_for_{{comment.pk}}" style="display: none;">
                {% render_comment_form for question with comment.pk %}
            </div>

            {% for close in comment.close %}
                </li>
                </ul>
            {% endfor %}
        {% endfor %}

        <a href="" class="pillbtn" onclick="$('#comment_form_for_question').toggle(); return false;">Add Comment</a>
        <div id="comment_form_for_question" style="display: none;">
            {% render_comment_form for question %}
        </div>
    </div>
</div>

{% endblock %}
